<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/core-ajax/core-ajax.html">

<polymer-element name="new-tournament" vertical layout>

    <template>
        <paper-dialog title="New tournament" id="new_tournament">

            <paper-input label="The tournament's name" value="{{tournamentName}}" id="tournamentName"></paper-input>
            <paper-button
                    primary
                    raisedButton
                    label="Send"
                    id="send"
                    on-tap="{{doSend}}"/>


            <core-ajax
                    auto="false"
                    method="POST"
                    url="/rest/tournament/new"
                    body='{"name":"{{tournamentName}}"}'
                    handleAs="json"
                    id="save"
                    contentType="application/json"
                    on-core-response="{{handleResponse}}"></core-ajax>
        </paper-dialog>

        <div>
            <paper-button label="New tournament" raisedButton primary on-tap="{{openDialog}}"/>
        </div>
    </template>
    <script>
        Polymer('new-tournament', {
            doSend: function (e) {
                this.$.save.go()
            },
            handleResponse: function (e) {
                this.fire('tournament_created');
                console.log(e.detail.response.id);
            },
            openDialog: function (e) {
                this.$.new_tournament.toggle();
            }
        });
    </script>
</polymer-element>